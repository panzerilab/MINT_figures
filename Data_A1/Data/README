%This MATLAB script will load an experiment from Francis et al, 2022 in Cell Reports, and give examples of
%how the data are stored. The same structure is used for both passive and behavior data.

%This needs to be changed to your local directory
load('D:\publishedDatasets\Francis_etal_2022_CellReports\Data\dataShare\Exp01.mat');

%Animal name
Behavior.Animal;

%DeltaF/F Fluorescence: frame X trial X neuron
Behavior.Fluorescence.DeltaF;

%Experiment matrices: Behavior.TagNames and Behavior.Tags. 
%Behavior.Tags has the same size as the first two dimensions in the fluorescence data. For example,
%the stimulus frequency for each trial:
figure

idx=find(strcmpi(Behavior.TagNames(:,2),'StimFrequency'));
Freqs = squeeze(Behavior.Tags(:,:,idx));
subplot(1,3,1)
imagesc(Freqs) %Each color represents one of the four frequencies and is shown at the time of stimulus onset
colormap(hot)
title('Stim. Freq.')

%the 'hit' trials
idx=find(strcmpi(Behavior.TagNames(:,2),'Hit'));
hits = squeeze(Behavior.Tags(:,:,idx));
subplot(1,3,2)
imagesc(hits) %white shows that the trial was a hit and is shown at the time of stimulus onset
title('Hit trials')

%licking during target trials
idx=find(strcmpi(Behavior.TagNames(:,2),'TargetLick'));
licks = squeeze(Behavior.Tags(:,:,idx));
subplot(1,3,3)
imagesc(licks) %white shows when a lick occured during a trial
title('Target licks')
